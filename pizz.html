<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pizzería Bella Napoli</title>
    <!-- Tu código existente -->
</head>
<body>
    <!-- Tu contenido HTML existente -->

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Configuración de jsPDF
            const { jsPDF } = window.jspdf;

            // Variables globales
            let pedido = {
                nombre: '',
                fecha: '',
                hora: '',
                pizzas: [],
                extras: [],
                total: 0,
                metodoPago: '',
                cambio: 0
            };

            // Navegación entre secciones
            document.getElementById("comenzar").addEventListener("click", function() {
                cambiarSeccion("bienvenida", "formulario-seccion");
            });

            document.getElementById("calcular").addEventListener("click", function() {
                if (!validarFormulario()) return;
                
                calcularPedido();
                mostrarResumen();
                cambiarSeccion("formulario-seccion", "detalle-seccion");
            });

            document.getElementById("continuarPago").addEventListener("click", function() {
                cambiarSeccion("detalle-seccion", "pago-seccion");
            });

            document.getElementById("regresarPedido").addEventListener("click", function() {
                cambiarSeccion("detalle-seccion", "formulario-seccion");
            });

            document.getElementById("regresarResumen").addEventListener("click", function() {
                cambiarSeccion("pago-seccion", "detalle-seccion");
            });

            // Métodos de pago
            document.querySelectorAll('input[name="metodoPago"]').forEach(radio => {
                radio.addEventListener("change", function() {
                    document.getElementById("pago-efectivo").classList.toggle("hidden", this.value !== "Efectivo");
                    document.getElementById("pago-tarjeta").classList.toggle("hidden", this.value !== "Tarjeta");
                });
            });

            document.getElementById("pagarEfectivo").addEventListener("click", function() {
                const recibido = parseFloat(document.getElementById("cantidadRecibida").value);

                if (recibido < pedido.total) {
                    alert(`El dinero recibido ($${recibido.toFixed(2)}) es menor al total ($${pedido.total.toFixed(2)})`);
                    return;
                }

                pedido.cambio = recibido - pedido.total;
                pedido.metodoPago = "Efectivo";
                document.getElementById("cambio").textContent = pedido.cambio.toFixed(2);
                mostrarTicket();
            });

            document.getElementById("pagarTarjeta").addEventListener("click", function() {
                if (!validarTarjeta()) return;

                pedido.metodoPago = "Tarjeta";
                pedido.cambio = 0;
                mostrarTicket();
            });

            // Generar PDF
            document.getElementById("descargarTicket").addEventListener("click", function() {
                generarPDF();
            });

            // Finalizar compra
            document.getElementById("terminarCompra").addEventListener("click", function() {
                alert("¡Gracias por tu compra! Tu pedido está en camino.");
                location.reload();
            });

            // Funciones auxiliares
            function cambiarSeccion(ocultar, mostrar) {
                document.getElementById(ocultar).classList.remove("activa");
                document.getElementById(mostrar).classList.add("activa");
                window.scrollTo(0, 0);
            }

            function validarFormulario() {
                const nombre = document.getElementById("nombre").value.trim();
                const fecha = document.getElementById("fecha").value;
                const hora = document.getElementById("hora").value;
                const pizza1 = document.getElementById("pizza1").value;

                if (!nombre) {
                    alert("Por favor ingresa tu nombre");
                    return false;
                }

                if (!fecha) {
                    alert("Por favor selecciona una fecha");
                    return false;
                }

                if (!hora) {
                    alert("Por favor selecciona una hora");
                    return false;
                }

                if (pizza1 === "" || pizza1 === "0") {
                    alert("Por favor selecciona al menos una pizza");
                    return false;
                }

                return true;
            }

            function calcularPedido() {
                // Tu lógica existente para calcular el pedido
            }

            function mostrarResumen() {
                // Tu lógica existente para mostrar el resumen
            }

            function validarTarjeta() {
                // Tu lógica existente para validar el pago con tarjeta
            }

            function generarPDF() {
                // Tu lógica existente para generar un PDF
            }

            function mostrarTicket() {
                // Tu lógica existente para mostrar el ticket
            }
        });
    </script>
</body>
</html>
