<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FashionShop - Neon Future</title>
    <!-- Fuentes Futuristas de Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* --- ESTRUCTURA DE DISEÑO "NEON FUTURE" --- */

        /* 1. Variables Globales para un Estilo Futurista */
        :root {
            --font-primary: 'Share Tech Mono', monospace;
            --font-secondary: 'Poppins', sans-serif;
            --color-bg: #0d0221;
            --color-surface: rgba(26, 12, 58, 0.7); /* Morado oscuro semitransparente */
            --color-text: #ffffff;
            --color-text-muted: #9e9e9e;
            --color-primary: #ff00e5; /* Magenta Neón */
            --color-secondary: #00f5ff; /* Cian Neón */
            --border-color: rgba(0, 245, 255, 0.3);
            --glow-primary: 0 0 5px var(--color-primary), 0 0 10px var(--color-primary), 0 0 15px var(--color-primary);
            --glow-secondary: 0 0 5px var(--color-secondary), 0 0 10px var(--color-secondary);
            --transition-speed: 0.3s;
            --cut-corner: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
        }

        /* 2. Keyframes para Animaciones */
        @keyframes glitch {
            0%, 100% { transform: skewX(0); }
            50% { transform: skewX(2deg); text-shadow: 2px 0 var(--color-secondary), -2px 0 var(--color-primary); }
        }

        /* 3. Reset y Estilos Generales */
        * {
            margin: 0; padding: 0; box-sizing: border-box; border-radius: 0;
        }
        
        body {
            background-color: var(--color-bg);
            background-image: 
                linear-gradient(var(--border-color) 1px, transparent 1px),
                linear-gradient(to right, var(--border-color) 1px, var(--color-bg) 1px);
            background-size: 30px 30px;
            color: var(--color-text);
            font-family: var(--font-secondary);
        }
        
        .container { max-width: 1280px; margin: 0 auto; padding: 0 20px; }
        h1, h2, h3, .logo { font-family: var(--font-primary); }
        a { text-decoration: none; color: inherit; }

        /* 4. Header y Navegación */
        header {
            background-color: rgba(13, 2, 33, 0.8);
            backdrop-filter: blur(12px);
            position: sticky; top: 0; z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }
        
        .top-bar {
            background-color: var(--color-primary);
            color: var(--color-bg);
            padding: 10px 0; font-size: 14px; text-align: center; font-weight: 700;
        }
        
        .main-header { display: flex; justify-content: space-between; align-items: center; padding: 20px 0; }
        
        .logo {
            font-size: 36px;
            color: var(--color-text);
            text-shadow: var(--glow-secondary);
        }
        
        .search-bar input {
            background-color: transparent; border: 1px solid var(--border-color);
            color: var(--color-text); font-family: var(--font-secondary);
            padding: 12px 20px; width: 100%; outline: none;
            transition: all var(--transition-speed);
        }
        .search-bar input:focus {
            border-color: var(--color-primary);
            box-shadow: inset 0 0 10px rgba(255, 0, 229, 0.5);
        }
        .search-bar input::placeholder { color: var(--color-text-muted); }
        
        .user-actions { display: flex; align-items: center; gap: 30px; }
        .user-actions a {
            font-size: 20px; transition: all var(--transition-speed);
        }
        .user-actions a:hover {
            color: var(--color-primary); transform: scale(1.1); text-shadow: var(--glow-primary);
        }
        
        .cart-count {
            position: absolute; top: -10px; right: -12px;
            background-color: var(--color-primary); color: var(--color-bg);
            width: 22px; height: 22px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 12px; font-weight: 700;
            box-shadow: var(--glow-primary);
        }
        
        .nav-links { display: flex; justify-content: center; list-style: none; }
        .nav-links li a {
            padding: 20px 25px; display: block; font-size: 16px;
        }
        .nav-links li a:hover, .nav-links li.active a {
            color: var(--color-primary);
            text-shadow: 0 0 5px var(--color-primary);
        }
        
        /* 5. Banner Principal */
        .main-banner {
            height: 650px;
            background-image: linear-gradient(rgba(13, 2, 33, 0.6), var(--color-bg)), url('https://images.unsplash.com/photo-1531297484001-80022131f5a1?auto=format&fit=crop&q=80&w=2020');
            background-size: cover; background-position: center;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; margin-bottom: 80px;
        }
        
        .banner-content h1 {
            font-size: 80px;
            color: var(--color-text);
            text-shadow: var(--glow-primary);
            animation: glitch 2s linear infinite;
        }
        .banner-content p { font-size: 20px; margin-bottom: 40px; color: var(--color-secondary); }
        
        .shop-now-btn {
            background-color: transparent; color: var(--color-primary);
            padding: 15px 40px; border: 2px solid var(--color-primary);
            font-size: 16px; font-family: var(--font-primary);
            cursor: pointer;
            clip-path: var(--cut-corner);
            box-shadow: inset 0 0 10px rgba(255,0,229,0.5), 0 0 10px rgba(255,0,229,0.5);
            transition: all var(--transition-speed);
        }
        .shop-now-btn:hover {
            background-color: var(--color-primary); color: var(--color-bg);
        }
        
        /* 6. Títulos de Sección */
        .section-title {
            text-align: center; margin-bottom: 60px; font-size: 52px;
            color: var(--color-text);
            text-shadow: 0 0 5px var(--color-secondary);
        }
        
        /* 7. Tarjetas (Categorías y Productos) - Glassmorphism */
        .category-grid, .product-grid {
            display: grid; grid-template-columns: repeat(4, 1fr);
            gap: 30px; margin-bottom: 80px;
        }
        
        .category-card, .product-card {
            background: var(--color-surface);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            clip-path: var(--cut-corner);
            overflow: hidden;
            transition: all var(--transition-speed) ease;
        }
        
        .category-card:hover, .product-card:hover {
            transform: translateY(-10px) scale(1.02);
            border-color: var(--color-primary);
            box-shadow: 0 0 20px rgba(255, 0, 229, 0.6);
        }
        
        .category-card { height: 350px; cursor: pointer; }
        .category-card img { width: 100%; height: 100%; object-fit: cover; transition: opacity 0.5s; opacity: 0.8; }
        .category-card:hover img { opacity: 1; }
        .category-overlay {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: linear-gradient(to top, rgba(13, 2, 33, 0.9), transparent);
            padding: 30px 20px; text-align: center;
        }
        .category-overlay h3 { font-size: 32px; color: var(--color-text); }
        
        .product-image { height: 300px; }
        .product-image img { width: 100%; height: 100%; object-fit: cover; }
        
        .product-info { padding: 20px; }
        .product-title {
            font-family: var(--font-secondary); font-weight: 500;
            font-size: 16px; margin-bottom: 10px; height: 40px; color: var(--color-text);
        }
        
        .product-price { display: flex; align-items: baseline; margin-bottom: 15px; font-weight: 700; }
        .current-price { font-size: 22px; color: var(--color-primary); text-shadow: 0 0 5px var(--color-primary); margin-right: 10px; }
        .original-price { text-decoration: line-through; color: var(--color-text-muted); font-size: 14px; }
        
        .add-to-cart {
            width: 100%; padding: 12px 0; background-color: var(--color-primary);
            color: var(--color-bg); border: none; cursor: pointer;
            font-family: var(--font-primary); font-size: 16px;
            transition: background-color var(--transition-speed);
        }
        .add-to-cart:hover { background-color: var(--color-secondary); }

        /* 8. Overlays (Carrito, Checkout, Ticket) */
        .cart-overlay, .checkout-overlay, .ticket-overlay {
            position: fixed; top: 0; right: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 1000; display: none;
            opacity: 0; transition: opacity var(--transition-speed) ease;
        }
        .cart-overlay.active, .checkout-overlay.active, .ticket-overlay.active { display: flex; opacity: 1; }

        .cart-container, .checkout-container, .ticket-container {
            background: var(--color-surface);
            backdrop-filter: blur(15px);
            border: 1px solid var(--border-color);
            padding: 25px;
        }

        .cart-container {
            width: 450px; height: 100%; margin-left: auto;
            transform: translateX(100%); transition: transform var(--transition-speed) ease;
            display: flex; flex-direction: column;
        }
        .cart-overlay.active .cart-container { transform: translateX(0); }
        
        .cart-header, .checkout-header, .ticket-header {
            padding-bottom: 20px; border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px; text-align: center;
        }
        .close-cart { cursor: pointer; position: absolute; top: 25px; right: 25px; font-size: 24px; }

        .cart-footer { padding: 25px; border-top: 1px solid var(--border-color); }
        .cart-total { font-weight: 700; font-size: 22px; text-align: right; }
        .checkout-btn {
             width: 100%; padding: 15px; margin-top: 20px; cursor: pointer;
             font-size: 16px; font-family: var(--font-primary);
             background-color: var(--color-primary); color: var(--color-bg);
             border: none; clip-path: var(--cut-corner);
        }
        .checkout-btn:hover { background-color: var(--color-secondary); }

        /* 9. Checkout Rediseñado */
        .checkout-overlay { justify-content: center; align-items: center; }
        .checkout-container { width: 700px; max-height: 90vh; overflow-y: auto; }
        
        .checkout-steps {
            display: flex; justify-content: space-between; margin-bottom: 40px;
        }
        .step {
            flex: 1; text-align: center; padding: 10px;
            border-bottom: 3px solid var(--border-color);
            color: var(--color-text-muted);
        }
        .step.active {
            border-bottom-color: var(--color-primary);
            color: var(--color-text);
            text-shadow: 0 0 5px var(--color-primary);
        }
        
        .form-group input, .form-group textarea {
            background: rgba(0,0,0,0.3); border: 1px solid var(--border-color);
            color: var(--color-text); padding: 10px; width: 100%;
        }
        .form-group input:focus, .form-group textarea:focus {
            outline: none; border-color: var(--color-primary);
        }
        
        .delivery-method, .payment-method {
            border: 2px solid var(--border-color); padding: 20px; cursor: pointer;
        }
        .delivery-method.selected, .payment-method.selected {
            border-color: var(--color-primary);
            background: rgba(255, 0, 229, 0.1);
        }
        
        .checkout-nav button { clip-path: var(--cut-corner); border: 2px solid; padding: 10px 30px; background: transparent; font-family: var(--font-primary);}
        .btn-back { border-color: var(--color-secondary); color: var(--color-secondary); }
        .btn-next { border-color: var(--color-primary); color: var(--color-primary); }
        .btn-back:hover { background: var(--color-secondary); color: var(--color-bg); }
        .btn-next:hover { background: var(--color-primary); color: var(--color-bg); }

        /* 10. Contacto y Footer */
        .contact-info, .social-media-section { padding: 80px 0; }
        .map-container iframe { filter: grayscale(100%) invert(90%) hue-rotate(180deg); }
        .submit-btn {
            clip-path: var(--cut-corner); background-color: var(--color-primary);
            color: var(--color-bg); border: none; padding: 15px 40px;
            font-family: var(--font-primary);
        }

        /* 11. Notificación */
        .notification {
            position: fixed; bottom: 20px; right: 20px;
            background-color: var(--color-primary); color: var(--color-bg);
            padding: 15px 30px; z-index: 2000;
            clip-path: var(--cut-corner);
            box-shadow: var(--glow-primary);
            opacity: 0; transform: translateX(100%);
            transition: all 0.5s;
        }
        .notification.show { opacity: 1; transform: translateX(0); }
        
        /* 12. Responsive */
        @media (max-width: 1200px) { .product-grid, .category-grid { grid-template-columns: repeat(3, 1fr); } }
        @media (max-width: 992px) { .product-grid, .category-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) {
            .main-header { flex-direction: column; gap: 20px; }
            .search-bar { width: 100%; margin: 0; }
            .banner-content h1 { font-size: 50px; }
            .product-grid, .category-grid { grid-template-columns: repeat(2, 1fr); }
            .cart-container, .checkout-container { width: 95%; }
        }
        @media (max-width: 576px) {
            .product-grid, .category-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header>
        <div class="top-bar">
            // ENVÍO GRATIS EN PEDIDOS > $50 //
        </div>
        <div class="container">
            <div class="main-header">
                <div class="logo">FASHIONSHOP</div>
                <div class="search-bar">
                    <input type="text" placeholder="BUSCAR_">
                </div>
                <div class="user-actions">
                    <a href="#"><i class="fas fa-user"></i></a>
                    <a href="#" id="cart-btn"><i class="fas fa-shopping-cart"></i> <span class="cart-count">0</span></a>
                </div>
            </div>
        </div>
        <nav>
            <div class="container">
                <ul class="nav-links">
                    <li><a href="#" class="nav-link active" data-category="all">INICIO</a></li>
                    <li><a href="#" class="nav-link" data-category="women">MUJER</a></li>
                    <li><a href="#" class="nav-link" data-category="men">HOMBRE</a></li>
                    <li><a href="#" class="nav-link" data-category="kids">NIÑOS</a></li>
                    <li><a href="#" class="nav-link" data-category="accessories">ACCESORIOS</a></li>
                    <li><a href="#" class="nav-link" data-category="shoes">ZAPATOS</a></li>
                    <li><a href="#" class="nav-link" data-category="offers">OFERTAS</a></li>
                </ul>
            </div>
        </nav>
    </header>
    
    <div id="home-page">
        <section class="main-banner">
            <div class="banner-content">
                <h1>NEON FUTURE</h1>
                <p>NUEVA COLECCIÓN // EDICIÓN LIMITADA</p>
                <button class="shop-now-btn">DESCUBRIR</button>
            </div>
        </section>
        
        <section class="container">
            <h2 class="section-title">CATEGORÍAS</h2>
            <div class="category-grid">
                <div class="category-card" data-category="women"><img src="https://images.unsplash.com/photo-1581044777550-4cfa6ce67943?auto=format&fit=crop&q=80&w=1887" alt="Ropa de mujer"><div class="category-overlay"><h3>MUJER</h3></div></div>
                <div class="category-card" data-category="men"><img src="https://images.unsplash.com/photo-1617137968427-85924c800a22?auto=format&fit=crop&q=80&w=1887" alt="Ropa de hombre"><div class="category-overlay"><h3>HOMBRE</h3></div></div>
                <div class="category-card" data-category="kids"><img src="https://images.unsplash.com/photo-1519238263530-99bdd1965342?auto=format&fit=crop&q=80&w=1887" alt="Ropa para niños"><div class="category-overlay"><h3>NIÑOS</h3></div></div>
                <div class="category-card" data-category="accessories"><img src="https://images.unsplash.com/photo-1593318534882-a0833a60a7e8?auto=format&fit=crop&q=80&w=1887" alt="Accesorios"><div class="category-overlay"><h3>ACCESORIOS</h3></div></div>
            </div>
        </section>
        
        <section class="container">
            <h2 class="section-title">DESTACADOS</h2>
            <div class="product-grid" id="product-grid"></div>
        </section>

        <section class="contact-info">
            <div class="container">
                <h2 class="section-title">UBICACIÓN</h2>
                <div class="map-container">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3762.888614771349!2d-99.1699496845337!3d19.42702074612172!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x85d1ff35f5bd1563%3A0x6c366f0e2de02ff7!2sEl%20%C3%81ngel%20de%20la%20Independencia!5e0!3m2!1ses-419!2smx!4v1624567890123!5m2!1ses-419!2smx" allowfullscreen="" loading="lazy"></iframe>
                </div>
            </div>
        </section>

        <section class="social-media-section">
            <div class="container">
                <h2 class="section-title">SÍGUENOS</h2>
                <div class="social-icons" style="justify-content:center; gap:20px; margin-top:20px;">
                    <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-pinterest"></i></a>
                </div>
            </div>
        </section>
        
        <section class="container" style="padding-bottom: 80px;">
            <div class="contact-form">
                <h2 class="section-title">CONTACTO</h2>
                <form id="feedback-form">
                    <div class="form-row" style="display:flex; gap:20px;"><div class="form-group" style="flex:1;"><label for="feedback-name">NOMBRE</label><input type="text" id="feedback-name" required></div><div class="form-group" style="flex:1;"><label for="feedback-email">EMAIL</label><input type="email" id="feedback-email" required></div></div>
                    <div class="form-group"><label for="feedback-message">MENSAJE</label><textarea id="feedback-message" rows="5" required></textarea></div>
                    <button type="submit" class="submit-btn" style="display:block; margin:20px auto 0;">ENVIAR</button>
                </form>
            </div>
        </section>
    </div>
    
    <div id="category-pages">
        <div class="category-page" id="women-page"><div class="container"><div class="category-header"><a href="#" class="back-to-home"><i class="fas fa-arrow-left"></i> VOLVER</a><h2>MUJER</h2></div><div class="product-grid" id="women-products"></div></div></div>
        <div class="category-page" id="men-page"><div class="container"><div class="category-header"><a href="#" class="back-to-home"><i class="fas fa-arrow-left"></i> VOLVER</a><h2>HOMBRE</h2></div><div class="product-grid" id="men-products"></div></div></div>
        <div class="category-page" id="kids-page"><div class="container"><div class="category-header"><a href="#" class="back-to-home"><i class="fas fa-arrow-left"></i> VOLVER</a><h2>NIÑOS</h2></div><div class="product-grid" id="kids-products"></div></div></div>
        <div class="category-page" id="accessories-page"><div class="container"><div class="category-header"><a href="#" class="back-to-home"><i class="fas fa-arrow-left"></i> VOLVER</a><h2>ACCESORIOS</h2></div><div class="product-grid" id="accessories-products"></div></div></div>
        <div class="category-page" id="shoes-page"><div class="container"><div class="category-header"><a href="#" class="back-to-home"><i class="fas fa-arrow-left"></i> VOLVER</a><h2>ZAPATOS</h2></div><div class="product-grid" id="shoes-products"></div></div></div>
        <div class="category-page" id="offers-page"><div class="container"><div class="category-header"><a href="#" class="back-to-home"><i class="fas fa-arrow-left"></i> VOLVER</a><h2>OFERTAS</h2></div><div class="product-grid" id="offers-products"></div></div></div>
    </div>
    
    <div class="cart-overlay" id="cart-overlay">
        <div class="cart-container">
            <div class="cart-header"><h2>CARRITO</h2><span class="close-cart" id="close-cart"><i class="fas fa-times"></i></span></div>
            <div class="cart-items" style="padding:25px; flex-grow:1; overflow-y:auto;"></div>
            <div class="cart-footer"><div class="cart-total">TOTAL: $<span id="cart-total">0.00</span></div><button class="checkout-btn" id="checkout-btn">FINALIZAR COMPRA</button></div>
        </div>
    </div>
    
    <div class="checkout-overlay" id="checkout-overlay">
        <div class="checkout-container">
            <div class="checkout-header"><h2>CHECKOUT</h2></div>
            <div class="checkout-steps">
                <div class="step active" data-step="1"><h3>1. INFO</h3></div>
                <div class="step" data-step="2"><h3>2. PAGO</h3></div>
                <div class="step" data-step="3"><h3>3. CONFIRMAR</h3></div>
            </div>
            <form class="checkout-form" id="checkout-form">
                <div class="checkout-step" id="step-1">
                    <h3>DATOS DEL CLIENTE</h3>
                    <div class="form-group"><label for="name">NOMBRE</label><input type="text" id="name" required></div>
                    <div class="form-group"><label for="email">EMAIL</label><input type="email" id="email" required></div>
                    <div class="form-group"><label for="phone">TELÉFONO</label><input type="tel" id="phone" required></div>
                    <h3 style="margin-top: 30px;">MÉTODO DE ENTREGA</h3>
                    <div class="delivery-methods" style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin:20px 0;"><div class="delivery-method" data-method="delivery"><i class="fas fa-truck"></i><div>ENVÍO</div></div><div class="delivery-method" data-method="pickup"><i class="fas fa-store"></i><div>RECOGER</div></div></div>
                    <div id="delivery-address-fields" style="display: none;"><div class="form-group"><label for="address">DIRECCIÓN</label><input type="text" id="address"></div><div class="form-group"><label for="city">CIUDAD</label><input type="text" id="city"></div><div class="form-group"><label for="zip">CÓDIGO POSTAL</label><input type="text" id="zip"></div></div>
                </div>
                <div class="checkout-step" id="step-2" style="display: none;">
                    <h3>MÉTODO DE PAGO</h3>
                    <div class="payment-methods" style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin:20px 0;"><div class="payment-method" data-method="card"><i class="far fa-credit-card"></i><div>TARJETA</div></div><div class="payment-method" data-method="cash"><i class="fas fa-money-bill-wave"></i><div>EFECTIVO</div></div></div>
                    <div id="card-details" style="display: none;"><div class="form-group"><label for="card-number">NÚMERO</label><input type="text" id="card-number" placeholder="XXXX XXXX XXXX XXXX"></div><div class="form-group"><label for="card-name">NOMBRE</label><input type="text" id="card-name"></div><div style="display: flex; gap: 15px;"><div class="form-group" style="flex: 1;"><label for="card-expiry">EXP</label><input type="text" id="card-expiry" placeholder="MM/AA"></div><div class="form-group" style="flex: 1;"><label for="card-cvv">CVV</label><input type="text" id="card-cvv" placeholder="XXX"></div></div></div>
                    <div id="cash-details" style="display: none;"><div class="form-group"><label for="cash-amount">PAGA CON:</label><input type="number" id="cash-amount" placeholder="500.00" step="0.01"></div></div>
                </div>
                <div class="checkout-step" id="step-3" style="display: none;">
                    <h3>RESUMEN DEL PEDIDO</h3>
                    <div class="order-summary" style="background:var(--color-bg); padding:20px; margin-top:20px;"><div class="order-summary-item" style="display:flex; justify-content:space-between; margin-bottom:10px;"><span>PRODUCTOS:</span><span id="order-subtotal">$0.00</span></div><div class="order-summary-item" style="display:flex; justify-content:space-between; margin-bottom:10px;"><span>ENVÍO:</span><span id="order-shipping">$5.00</span></div><div class="order-summary-item order-total" style="display:flex; justify-content:space-between; font-weight:700; font-size:18px; border-top:1px solid var(--border-color); padding-top:10px; margin-top:10px;"><span>TOTAL:</span><span id="order-total">$0.00</span></div></div>
                    <div id="delivery-info" style="margin-top: 20px;"><h4>ENTREGA:</h4><p id="selected-delivery-method"></p><p id="delivery-address"></p></div>
                    <div id="payment-info" style="margin-top: 20px;"><h4>PAGO:</h4><p id="selected-payment-method"></p><p id="cash-paid-info" style="display: none;"></p><p id="cash-change-info" style="display: none;"></p></div>
                    <button type="button" id="confirm-order" class="btn-next" style="width: 100%; margin-top: 30px;">CONFIRMAR PEDIDO</button>
                </div>
                <div class="checkout-nav" style="display:flex; justify-content:space-between; margin-top:30px;"><button type="button" class="btn-back" id="btn-back" style="display: none;">ATRÁS</button><button type="button" class="btn-next" id="btn-next">SIGUIENTE</button></div>
            </form>
        </div>
    </div>
    
    <div class="ticket-overlay" id="ticket-overlay">
        <div class="ticket-container">
            <div class="ticket-header"><h2>GRACIAS</h2><p>PEDIDO PROCESADO</p></div>
            <div class="ticket-details" style="text-align:left; border-top:1px solid var(--border-color); border-bottom:1px solid var(--border-color); padding:15px 0;"><p><strong>PEDIDO:</strong> <span id="ticket-number"></span></p><p><strong>FECHA:</strong> <span id="ticket-date"></span></p><p><strong>CLIENTE:</strong> <span id="ticket-customer"></span></p><p><strong>ENTREGA:</strong> <span id="ticket-delivery"></span></p><p><strong>PAGO:</strong> <span id="ticket-payment"></span></p><p id="ticket-cash-paid-container" style="display: none;"><strong>PAGA CON:</strong> <span id="ticket-cash-paid"></span></p><p id="ticket-cash-change-container" style="display: none;"><strong>CAMBIO:</strong> <span id="ticket-cash-change"></span></p></div>
            <div class="ticket-items" id="ticket-items" style="text-align:left; padding:15px 0;"></div>
            <div class="ticket-total" style="text-align:right; font-size:18px; font-weight:700; border-top:1px solid var(--border-color); padding-top:15px;">TOTAL: <span id="ticket-total-final">0.00</span></div>
            <button class="btn-download" id="download-ticket" style="clip-path:var(--cut-corner); border:none; background:var(--color-primary); color:var(--color-bg); padding:12px 30px; margin-top:20px; font-family:var(--font-primary);">DESCARGAR</button>
        </div>
    </div>
    
    <script>
        // --- EL JAVASCRIPT PERMANECE IDÉNTICO, SOLO CAMBIAN LAS CLASES EN EL HTML ---
        let cart = [];
        let currentStep = 1;
        let selectedDeliveryMethod = '';
        let lastOrderData = {}; 
        
        const cartBtn = document.getElementById('cart-btn');
        const cartOverlay = document.getElementById('cart-overlay');
        const closeCart = document.getElementById('close-cart');
        const cartItemsContainer = document.getElementById('cart-items');
        const cartTotal = document.getElementById('cart-total');
        const cartCount = document.querySelector('.cart-count');
        const checkoutBtn = document.getElementById('checkout-btn');
        const checkoutOverlay = document.getElementById('checkout-overlay');
        const checkoutForm = document.getElementById('checkout-form');
        const btnNext = document.getElementById('btn-next');
        const btnBack = document.getElementById('btn-back');
        const confirmOrder = document.getElementById('confirm-order');
        const ticketOverlay = document.getElementById('ticket-overlay');
        const downloadTicket = document.getElementById('download-ticket');
        const homePage = document.getElementById('home-page');
        const categoryPages = document.getElementById('category-pages');
        const navLinks = document.querySelectorAll('.nav-link');
        const categoryCards = document.querySelectorAll('.category-card');
        const backToHomeLinks = document.querySelectorAll('.back-to-home');
        const deliveryMethods = document.querySelectorAll('.delivery-method');
        const deliveryAddressFields = document.getElementById('delivery-address-fields');
        const feedbackForm = document.getElementById('feedback-form');
        
        const products = { all:[{id:"women-1",name:"Elegante Vestido Negro",price:59.99,discount:20,image:"https://m.media-amazon.com/images/I/41dxRYpZZ+L._AC_SY1000_.jpg",category:"women"},{id:"men-1",name:"Moderno Traje Azul",price:89.99,discount:15,image:"https://cdn0.bodas.com.mx/article-dress/9631/original/1280/jpg/m851369.jpeg",category:"men"},{id:"kids-1",name:"Divertido Conjunto Rosa",price:29.99,discount:10,image:"https://www.gerat.com.mx/cdn/shop/files/4220.jpg?v=1726269356",category:"kids"},{id:"accessories-1",name:"Estiloso Bolso Negro",price:39.99,discount:0,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTpUGITJJK3xB3LlDKuUojxGgWRymGUieKWIQ&s",category:"accessories"},{id:"shoes-1",name:"Cómodos Zapatos Blancos",price:49.99,discount:25,image:"https://img.kwcdn.com/product/fancy/d9b20ec8-4c58-414b-ac5d-a35cd61283ab.jpg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/webp",category:"shoes"},{id:"women-2",name:"Blusa Elegante Blanca",price:34.99,discount:0,image:"https://http2.mlstatic.com/D_NQ_NP_785203-CBT75318563788_032024-O-blusa-blanca-con-botones-moda-casual-elegante-para-mujer.webp",category:"women"},{id:"men-2",name:"Camisa Formal Gris",price:44.99,discount:10,image:"https://m.media-amazon.com/images/I/61m7p0-n0lL._AC_UF894,1000_QL80_.jpg",category:"men"},{id:"kids-2",name:"Conjunto Deportivo Azul",price:24.99,discount:0,image:"https://assets.adidas.com/images/h_840,f_auto,q_auto,fl_lossy,c_fill,g_auto/0582a451101949409d55b11f2bb36fb7_9366/Conjunto_Deportivo_Adicolor_SST_Azul_IP6694_21_model.jpg",category:"kids"},{id:"accessories-2",name:"Reloj de Lujo Dorado",price:99.99,discount:30,image:"https://m.media-amazon.com/images/I/51xnhnd8wES._AC_SY900_.jpg",category:"accessories"},{id:"shoes-2",name:"Botas de Cuero Marrón",price:79.99,discount:15,image:"https://i.etsystatic.com/20690652/r/il/c86e3c/6102406728/il_570xN.6102406728_m2yg.jpg",category:"shoes"}],women:[{id:"women-1",name:"Elegante Vestido Rosa",price:59.99,discount:20,image:"https://m.media-amazon.com/images/I/41mX4D1UBtL._AC_.jpg",category:"women"},{id:"women-2",name:"Blusa Elegante rosa",price:34.99,discount:0,image:"https://i5.walmartimages.com/asr/dd4a1b42-7bdb-414b-addd-667d37ef270f.d14463b6d79de52724af2e078c5d27ff.jpeg?odnHeight=612&odnWidth=612&odnBg=FFFFFF",category:"women"},{id:"women-3",name:"Falda Plisada Roja",price:39.99,discount:15,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSuHFhhK_Rp3zFLA-jTRWp3uQlQlb98Hprtqw&s",category:"women"},{id:"women-4",name:"Jeans Skinny Azul",price:49.99,discount:10,image:"https://pantalonesdemezclilla.mx/cdn/shop/files/Skinny-Jeans-Damas-Azul-Claro.png?v=1713382780",category:"women"},{id:"women-5",name:"Abrigo Largo Beige",price:89.99,discount:25,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQL6WYkw105WcHsPlpobDdvLf_ur0hJpGUl0w&s",category:"women"},{id:"women-6",name:"Top de Encaje Negro",price:29.99,discount:0,image:"https://lh5.googleusercontent.com/proxy/wHPmvOK7mZazIpJ1aptU2XN9gZhleBSlNh_V74x8vAXB6752YMpVfGAdFi4LzB02cbLAYoy2KRnJPLdUHfwHDaFKPENRPNS0x8PGMUtH_fQ",category:"women"},{id:"women-7",name:"Short Denim Azul",price:34.99,discount:0,image:"https://i.etsystatic.com/14706918/r/il/dd1912/1166619688/il_1080xN.1166619688_jk0o.jpg",category:"women"},{id:"women-8",name:"Chamarra de Cuero Negro",price:99.99,discount:30,image:"https://casapiel.com.mx/cdn/shop/files/casa-piel-chamarra-de-piel-dama-alemania-negro-1_549c2455-695a-4dfc-9765-f720bb777c20.jpg?v=1719603409",category:"women"},{id:"women-9",name:"Vestido Floral Veraniego",price:44.99,discount:15,image:"https://i.pinimg.com/736x/bd/17/77/bd17779372daf2fa380b459c5a5336ad.jpg",category:"women"},{id:"women-10",name:"Blazer Formal Gris",price:69.99,discount:0,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT1kdqYdf2LLIxwtx5o7eqO5KbdJaW0ir7Q2A&s",category:"women"}],men:[{id:"men-1",name:"Moderno Traje Negro",price:89.99,discount:15,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRUNGGv9h42HYmxVQop6uRFLRW8YiI8jHgHDw&s",category:"men"},{id:"men-2",name:"Camisa Formal Verde",price:44.99,discount:10,image:"https://i.ebayimg.com/images/g/PU8AAOSwWAxlxpYz/s-l400.jpg",category:"men"},{id:"men-3",name:"Pantalón de Vestir Negro",price:49.99,discount:0,image:"https://ss855.suburbia.com.mx/xl/5004219599.jpg",category:"men"},{id:"men-4",name:"Sudadera con Capucha",price:39.99,discount:20,image:"https://m.media-amazon.com/images/I/51l2Q9HhtuL._AC_UF894,1000_QL80_.jpg",category:"men"},{id:"men-5",name:"Chaqueta de Mezclilla",price:59.99,discount:0,image:"https://www.tntjeans.com.mx/wp-content/uploads/2023/02/502-1.jpg",category:"men"},{id:"men-6",name:"Jeans Slim Fit",price:49.99,discount:10,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR8tyApQWBPtz5qbX1VAmg-RHSx-1qzJRiNKg&s",category:"men"},{id:"men-7",name:"Playera Básica Blanca",price:19.99,discount:0,image:"https://eurocotton.vtexassets.com/arquivos/ids/163257/TCOMADCBLA-2.jpg?v=638842373182270000",category:"men"},{id:"men-8",name:"Short Deportivo Negro",price:29.99,discount:15,image:"https://acide.com.mx/cdn/shop/files/ShortMexicocaballerofrente_1024x1024@2x.png?v=1701984228",category:"men"},{id:"men-9",name:"Chaleco Elegante Gris",price:39.99,discount:0,image:"https://m.media-amazon.com/images/I/51nlN9tWplL._AC_UY1000_.jpg",category:"men"},{id:"men-10",name:"Traje de Baño Azul",price:34.99,discount:0,image:"https://m.media-amazon.com/images/I/31MP9sBsnAL._AC_.jpg",category:"men"}],kids:[{id:"kids-1",name:"Divertido Conjunto Morado",price:29.99,discount:10,image:"https://www.gerat.com.mx/cdn/shop/files/3885_mod_1880x.jpg?v=1715715532",category:"kids"},{id:"kids-2",name:"Conjunto Deportivo Celeste",price:24.99,discount:0,image:"https://assets.adidas.com/images/h_840,f_auto,q_auto,fl_lossy,c_fill,g_auto/dbd6bf2f098342699648af62010a8f13_9366/Conjunto_Deportivo_Adicolor_SST_Azul_IC9186_21_model.jpg",category:"kids"},{id:"kids-3",name:"Vestido de Niña con Flores",price:34.99,discount:15,image:"https://m.media-amazon.com/images/I/51wttJjuC6L._AC_SY1000_.jpg",category:"kids"},{id:"kids-4",name:"Playera Infantil con Estampado",price:19.99,discount:0,image:"https://imagena1.lacoste.com/dw/image/v2/AAUP_PRD/on/demandware.static/-/Sites-master/default/dw0ca9c87f/TJ2463_BMY_20.jpg?imwidth=615&impolicy=pctp",category:"kids"},{id:"kids-5",name:"Pantalón de Niño Café",price:24.99,discount:0,image:"https://cdn1.coppel.com/images/catalog/pr/2165642-1.jpg?iresize=width:400,height:320",category:"kids"},{id:"kids-6",name:"Champara Infantil Amarilla",price:39.99,discount:20,image:"https://m.media-amazon.com/images/I/41i8MsKMzDL._AC_.jpg",category:"kids"},{id:"kids-7",name:"Falda de Niña Roja",price:22.99,discount:0,image:"https://m.media-amazon.com/images/I/41acZEyawFL._AC_SY1000_.jpg",category:"kids"},{id:"kids-8",name:"Short Deportivo Negro",price:19.99,discount:0,image:"https://assets.adidas.com/images/w_383,h_383,f_auto,q_auto,fl_lossy,c_fill,g_auto/1bc789c5d50a43f69f793afdd6e72b74_9366/shorts-essentials-kids.jpg",category:"kids"},{id:"kids-9",name:"Sudadera Infantil con Capucha",price:29.99,discount:10,image:"https://m.media-amazon.com/images/I/314c9bS-QJL._AC_SY1000_.jpg",category:"kids"},{id:"kids-10",name:"Pijama Infantil de Dinosaurios",price:34.99,discount:0,image:"https://i5.walmartimages.com/asr/c38b271b-0e81-4b8a-bd23-9b5ba2becb4f.813e2b6672ef1b704e5900bc6ee3ce84.jpeg?odnHeight=612&odnWidth=612&odnBg=FFFFFF&format=avif",category:"kids"}],accessories:[{id:"accessories-1",name:"Estiloso Bolso Rosa",price:39.99,discount:0,image:"https://i5.walmartimages.com/asr/6d0014e3-35c4-4858-8cea-fcf207a3946b.561390dd9a00aa3a76b0087634798abf.png?odnHeight=612&odnWidth=612&odnBg=FFFFFF",category:"accessories"},{id:"accessories-2",name:"Reloj de Lujo Plateado",price:99.99,discount:30,image:"https://m.media-amazon.com/images/I/71StpOumTjL.jpg",category:"accessories"},{id:"accessories-3",name:"Cinturón de Cuero Negro",price:29.99,discount:0,image:"https://i5.walmartimages.com/asr/d3872d0a-45e6-4d52-ac18-df9a1c92b57f.28de6d11a19c7d028fce25d133500cb4.jpeg?odnHeight=612&odnWidth=612&odnBg=FFFFFF",category:"accessories"},{id:"accessories-4",name:"Gorra Deportiva Negra",price:24.99,discount:0,image:"https://cdn1.coppel.com/images/catalog/mkp/9912/3000/99121094-1.jpg",category:"accessories"},{id:"accessories-5",name:"Bufanda de Lana Gris",price:19.99,discount:15,image:"https://m.media-amazon.com/images/I/615FO3wsLnL.jpg",category:"accessories"},{id:"accessories-6",name:"Lentes de Sol Aviador",price:49.99,discount:20,image:"https://lux.mx/cdn/shop/products/8056597259828_2.jpg?v=1675201276",category:"accessories"},{id:"accessories-7",name:"Collar Elegante Plateado",price:34.99,discount:0,image:"https://accesoriosmonani.com/wp-content/uploads/2024/04/1000210390.jpg",category:"accessories"},{id:"accessories-8",name:"Sombrero de Paja",price:29.99,discount:0,image:"https://i.etsystatic.com/22196987/r/il/8c8b7d/2430005524/il_fullxfull.2430005524_453i.jpg",category:"accessories"},{id:"accessories-9",name:"Mochila Urbana Negra",price:59.99,discount:10,image:"https://http2.mlstatic.com/D_NQ_NP_816736-MLU75847718568_042024-O.webp",category:"accessories"},{id:"accessories-10",name:"Billetera de Cuero Marrón",price:39.99,discount:0,image:"https://cdn1.coppel.com/images/catalog/mkp/6126/3000/61261308-1.jpg",category:"accessories"}],shoes:[{id:"shoes-1",name:"Cómodos Zapatos Negros",price:49.99,discount:25,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRuygFQDpJlZ8bwOAPmaBOmlnaZN9SLmX8IPw&s",category:"shoes"},{id:"shoes-2",name:"Botas de Cuero Marrón",price:79.99,discount:15,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRnJt5qWW1dPoIMGQrDy26rpYef2zIFpyOndQ&s",category:"shoes"},{id:"shoes-3",name:"Tenis Deportivos Negros",price:59.99,discount:20,image:"https://lhesh.mx/245600-large_default/tenis-deportivo-de-inyeccion-para-dama-talla-mx-25-europea-40-voltix.jpg",category:"shoes"},{id:"shoes-4",name:"Zapatillas Casuales Grises",price:44.99,discount:0,image:"https://i5.walmartimages.com/asr/2ef78428-aa01-4b37-a05f-bee398d4e8d6.60d14045b24fb0c79b1c424c8d3be2e1.jpeg?odnHeight=612&odnWidth=612&odnBg=FFFFFF",category:"shoes"},{id:"shoes-5",name:"Botines de Ante Negro",price:69.99,discount:10,image:"https://skkoencalzado.com/67-medium_default/bellos-botines-de-ante-y-gamuza.jpg",category:"shoes"},{id:"shoes-6",name:"Sandalias de Playa",price:29.99,discount:0,image:"https://i5.walmartimages.com/asr/5594be80-5ac9-488d-b0ff-849ede729067.3b5c0242c6a67281b33eae1c93353c9c.jpeg?odnHeight=612&odnWidth=612&odnBg=FFFFFF",category:"shoes"},{id:"shoes-7",name:"Tacones Elegantes Nude",price:54.99,discount:15,image:"https://i.pinimg.com/1200x/1a/49/cd/1a49cd03238d76827024413d22a1b3b0.jpg",category:"shoes"},{id:"shoes-8",name:"Mocasines de Cuero Negro",price:49.99,discount:0,image:"https://brantano.com.mx/cdn/shop/files/JR510_NGOPIEHA.jpg?v=1738354923",category:"shoes"},{id:"shoes-9",name:"Zapatos Formales Negros",price:64.99,discount:20,image:"https://m.media-amazon.com/images/I/71aQfqEX2lL._AC_UY300_.jpg",category:"shoes"},{id:"shoes-10",name:"Chanclas de Playa",price:19.99,discount:0,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRhPI3l4nneO9pPu1J9eoCsrkIKGt0_DmsdBg&s",category:"shoes"}],offers:[{id:"offers-1",name:"Vestido de Fiesta - Oferta Especial",price:39.99,discount:40,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQeyY2tBc3ejC7TvRMiHZy2CEvsaQimU1M3yQ&s",category:"offers"},{id:"offers-2",name:"Traje Formal - Descuento",price:69.99,discount:35,image:"https://vittorioforti.com.mx/cdn/shop/files/VTR026NE_04.jpg?v=1748228116",category:"offers"},{id:"offers-3",name:"Conjunto Infantil - Liquidación",price:19.99,discount:50,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRMV6rD_TS1ApYhmbXeG_NfagGCNmdbLc9Npg&s",category:"offers"},{id:"offers-4",name:"Bolso de Diseño - Promoción",price:29.99,discount:45,image:"https://i5.walmartimages.com/asr/84f64a65-b7d1-440c-b22e-a3662848acae.9d15fd91e5af58401128ff3fd0104df8.jpeg?odnHeight=612&odnWidth=612&odnBg=FFFFFF",category:"offers"},{id:"offers-5",name:"Zapatos de Cuero - Oferta",price:39.99,discount:50,image:"https://m.media-amazon.com/images/I/617v-o7I80L._AC_UF894,1000_QL80_.jpg",category:"offers"},{id:"offers-6",name:"Pack de 3 Playeras - Combo",price:29.99,discount:40,image:"https://m.media-amazon.com/images/I/31Za1reZJ4L._AC_SY1000_.jpg",category:"offers"},{id:"offers-7",name:"Jeans Slim  - Últimas Unidades",price:34.99,discount:30,image:"https://pantalonesdemezclilla.mx/cdn/shop/files/Rotos-Slim-Jeans-Azules-Para-Hombre_2_8b9acbe3-0983-4593-801f-bd38b7fd8b1f.jpg?v=1741616663",category:"offers"},{id:"offers-8",name:"Reloj Elegante - Edición Limitada",price:59.99,discount:50,image:"https://m.media-amazon.com/images/I/51uTaNeNbtL._AC_SY900_.jpg",category:"offers"},{id:"offers-9",name:"Chaqueta de Cuero - Oferta Flash",price:79.99,discount:40,image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTiV8IK1mklHD-yn8roZnfbRnXGnewzDDKBWA&s",category:"offers"},{id:"offers-10",name:"Botas de Invierno - Descuento",price:49.99,discount:45,image:"https://i5.walmartimages.com/asr/97f7b2d3-6cc8-4e2a-84c9-5e3b47b743d5.8560ebabb165e85631279a35f3067cee.jpeg?odnHeight=612&odnWidth=612&odnBg=FFFFFF",category:"offers"}]};

        function getOrderTotal() {
            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            const shipping = (selectedDeliveryMethod === 'delivery' || (cart.length > 0 && subtotal < 50 && selectedDeliveryMethod !== 'pickup')) ? 5.00 : 0;
            return subtotal + shipping;
        }

        function renderProducts(products, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = '';
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.dataset.id = product.id;
                productCard.dataset.name = product.name;
                productCard.dataset.price = product.price.toFixed(2);
                productCard.dataset.image = product.image;
                const finalPrice = (product.price * (1 - product.discount/100)).toFixed(2);
                productCard.innerHTML = `<div class="product-image"><img src="${product.image}" alt="${product.name}"></div><div class="product-info"><h3 class="product-title">${product.name}</h3><div class="product-price"><span class="current-price">$${finalPrice}</span>${product.discount > 0 ? `<span class="original-price">$${product.price.toFixed(2)}</span>` : ''}</div></div><button class="add-to-cart">AÑADIR</button>`;
                container.appendChild(productCard);
            });
            document.querySelectorAll('.add-to-cart').forEach(button => button.addEventListener('click', addToCart));
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            if(localStorage.getItem('cart')) {
                cart = JSON.parse(localStorage.getItem('cart'));
                updateCart();
            }
            renderProducts(products.all, 'product-grid');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const category = this.dataset.category;
                    navLinks.forEach(l => l.parentElement.classList.remove('active'));
                    this.parentElement.classList.add('active');
                    if(category === 'all') {
                        homePage.style.display = 'block';
                        categoryPages.style.display = 'none';
                    } else {
                        homePage.style.display = 'none';
                        categoryPages.style.display = 'block';
                        document.querySelectorAll('.category-page').forEach(page => page.style.display = 'none');
                        const targetPage = document.getElementById(`${category}-page`);
                        if (targetPage) {
                            targetPage.style.display = 'block';
                            renderProducts(products[category], `${category}-products`);
                        }
                    }
                });
            });
            categoryCards.forEach(card => {
                card.addEventListener('click', function() {
                    const category = this.dataset.category;
                    const link = document.querySelector(`.nav-link[data-category="${category}"]`);
                    if(link) link.click();
                });
            });
            backToHomeLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelector('.nav-link[data-category="all"]').click();
                });
            });
            cartBtn.addEventListener('click', () => cartOverlay.classList.add('active'));
            closeCart.addEventListener('click', () => cartOverlay.classList.remove('active'));
            checkoutBtn.addEventListener('click', openCheckout);
            btnNext.addEventListener('click', nextStep);
            btnBack.addEventListener('click', prevStep);
            confirmOrder.addEventListener('click', completeOrder);
            deliveryMethods.forEach(method => method.addEventListener('click', selectDeliveryMethod));
            document.querySelectorAll('.payment-method').forEach(method => method.addEventListener('click', selectPaymentMethod));
            downloadTicket.addEventListener('click', generatePDF);
            feedbackForm.addEventListener('submit', submitFeedback);
        });
        
        function addToCart(e) {
            const productCard = e.target.closest('.product-card');
            const product = {
                id: productCard.dataset.id,
                name: productCard.dataset.name,
                price: parseFloat(productCard.querySelector('.current-price').textContent.replace('$', '')),
                image: productCard.dataset.image,
            };
            const existingItem = cart.find(item => item.id === product.id);
            if(existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            updateCart();
            showNotification(`${product.name} AÑADIDO`);
        }

        function updateCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            cartCount.textContent = totalItems;
            cartCount.style.display = totalItems > 0 ? 'flex' : 'none';
            cartItemsContainer.innerHTML = cart.length === 0 ? '<p style="text-align:center; color: var(--color-text-muted);">CARRITO VACÍO</p>' : '';
            let total = 0;
            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `<img src="${item.image}" style="width:80px; height:80px; object-fit:cover; clip-path:var(--cut-corner);"><div style="flex-grow:1;"><h4 style="font-size:16px;">${item.name}</h4><p style="color:var(--color-primary); font-weight:700;">$${item.price.toFixed(2)}</p><div style="display:flex; margin-top:5px;"><button class="quantity-btn minus" data-id="${item.id}" style="width:25px;height:25px;background:transparent;border:1px solid var(--border-color);color:var(--color-text);">-</button><input type="text" value="${item.quantity}" readonly style="width:30px;height:25px;text-align:center;background:var(--color-bg);border:1px solid var(--border-color);border-left:none;border-right:none;"><button class="quantity-btn plus" data-id="${item.id}" style="width:25px;height:25px;background:transparent;border:1px solid var(--border-color);color:var(--color-text);">+</button></div></div><span class="cart-item-remove" data-id="${item.id}" style="cursor:pointer;color:var(--color-text-muted);"><i class="fas fa-times"></i></span>`;
                cartItemsContainer.appendChild(cartItem);
                total += item.price * item.quantity;
            });
            cartTotal.textContent = total.toFixed(2);
            document.querySelectorAll('.quantity-btn').forEach(b => b.addEventListener('click', updateQuantity));
            document.querySelectorAll('.cart-item-remove').forEach(b => b.addEventListener('click', removeItem));
        }
        
        function updateQuantity(e) {
            const id = e.currentTarget.dataset.id;
            const item = cart.find(item => item.id === id);
            if (e.currentTarget.classList.contains('plus')) {
                item.quantity++;
            } else if (e.currentTarget.classList.contains('minus')) {
                item.quantity > 1 ? item.quantity-- : cart = cart.filter(i => i.id !== id);
            }
            updateCart();
        }

        function removeItem(e) {
            cart = cart.filter(item => item.id !== e.currentTarget.dataset.id);
            updateCart();
        }
        
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 500);
            }, 2000);
        }

        function openCheckout() {
            if (cart.length === 0) { alert('Tu carrito está vacío.'); return; }
            cartOverlay.classList.remove('active');
            checkoutOverlay.classList.add('active');
            updateOrderSummary();
        }
        
        function nextStep() {
            if (currentStep === 1) {
                if (!document.getElementById('name').value || !document.getElementById('email').value || !document.getElementById('phone').value) { alert('Completa tus datos.'); return; }
                if (selectedDeliveryMethod === 'delivery' && (!document.getElementById('address').value || !document.getElementById('city').value || !document.getElementById('zip').value)) { alert('Completa tu dirección.'); return; }
                if(!selectedDeliveryMethod) { alert('Selecciona un método de entrega.'); return; }
                currentStep = 2;
            } else if (currentStep === 2) {
                const selectedPayment = document.querySelector('.payment-method.selected');
                if (!selectedPayment) { alert('Selecciona un método de pago.'); return; }
                if (selectedPayment.dataset.method === 'card') {
                    if (!document.getElementById('card-number').value || !document.getElementById('card-name').value || !document.getElementById('card-expiry').value || !document.getElementById('card-cvv').value) { alert('Completa los datos de la tarjeta.'); return; }
                } else if (selectedPayment.dataset.method === 'cash') {
                    const cashAmount = parseFloat(document.getElementById('cash-amount').value);
                    if (isNaN(cashAmount) || cashAmount < getOrderTotal()) { alert(`El monto debe ser al menos $${getOrderTotal().toFixed(2)}.`); return; }
                }
                currentStep = 3;
                prepareConfirmationScreen();
            }
            updateCheckoutView();
        }
        
        function prevStep() {
            if (currentStep > 1) currentStep--;
            updateCheckoutView();
        }
        
        function updateCheckoutView() {
            document.querySelectorAll('.checkout-step').forEach(s => s.style.display = 'none');
            document.getElementById(`step-${currentStep}`).style.display = 'block';
            document.querySelectorAll('.step').forEach((s, i) => s.classList.toggle('active', i + 1 === currentStep));
            btnBack.style.display = currentStep > 1 ? 'inline-block' : 'none';
            btnNext.style.display = currentStep < 3 ? 'inline-block' : 'none';
        }

        function selectDeliveryMethod(e) {
            deliveryMethods.forEach(m => m.classList.remove('selected'));
            const method = e.currentTarget;
            method.classList.add('selected');
            selectedDeliveryMethod = method.dataset.method;
            deliveryAddressFields.style.display = selectedDeliveryMethod === 'delivery' ? 'block' : 'none';
            updateOrderSummary();
        }
        
        function selectPaymentMethod(e) {
            document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('selected'));
            e.currentTarget.classList.add('selected');
            document.getElementById('card-details').style.display = e.currentTarget.dataset.method === 'card' ? 'block' : 'none';
            document.getElementById('cash-details').style.display = e.currentTarget.dataset.method === 'cash' ? 'block' : 'none';
        }
        
        function updateOrderSummary() {
            const subtotal = cart.reduce((t, i) => t + (i.price * i.quantity), 0);
            const shipping = getOrderTotal() - subtotal;
            document.getElementById('order-subtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('order-shipping').textContent = `$${shipping.toFixed(2)}`;
            document.getElementById('order-total').textContent = `$${(subtotal + shipping).toFixed(2)}`;
        }

        function prepareConfirmationScreen() {
            const total = getOrderTotal();
            const deliveryEl = document.querySelector('.delivery-method.selected');
            const paymentEl = document.querySelector('.payment-method.selected');
            document.getElementById('selected-delivery-method').textContent = deliveryEl.innerText.trim();
            document.getElementById('delivery-address').textContent = selectedDeliveryMethod === 'delivery' ? `${document.getElementById('address').value}, ${document.getElementById('city').value}` : 'Recoger en tienda';
            document.getElementById('selected-payment-method').textContent = paymentEl.innerText.trim();
            if (paymentEl.dataset.method === 'cash') {
                const cash = parseFloat(document.getElementById('cash-amount').value);
                document.getElementById('cash-paid-info').textContent = `PAGA CON: $${cash.toFixed(2)}`;
                document.getElementById('cash-change-info').textContent = `CAMBIO: $${(cash - total).toFixed(2)}`;
                document.getElementById('cash-paid-info').style.display = 'block';
                document.getElementById('cash-change-info').style.display = 'block';
            } else {
                document.getElementById('cash-paid-info').style.display = 'none';
                document.getElementById('cash-change-info').style.display = 'none';
            }
        }

        function completeOrder() {
            const total = getOrderTotal();
            const subtotal = cart.reduce((t, i) => t + (i.price * i.quantity), 0);
            const paymentMethod = document.querySelector('.payment-method.selected').dataset.method;
            lastOrderData = {
                items: JSON.parse(JSON.stringify(cart)),
                orderNumber: 'FS-' + new Date().getFullYear() + '-' + Math.floor(1000 + Math.random() * 9000),
                date: new Date().toLocaleDateString('es-MX'),
                customer: document.getElementById('name').value,
                deliveryMethod: document.querySelector('.delivery-method.selected').innerText.trim(),
                paymentMethod: document.querySelector('.payment-method.selected').innerText.trim(),
                paymentMethodType: paymentMethod,
                total: total.toFixed(2), subtotal: subtotal.toFixed(2), shipping: (total - subtotal).toFixed(2),
            };
            if (paymentMethod === 'cash') {
                const cashAmount = parseFloat(document.getElementById('cash-amount').value);
                lastOrderData.cashPaid = cashAmount.toFixed(2);
                lastOrderData.changeDue = (cashAmount - total).toFixed(2);
            }
            showTicket();
            cart = [];
            updateCart();
            localStorage.removeItem('cart');
            resetCheckout();
        }

        function showTicket() {
            document.getElementById('ticket-number').textContent = lastOrderData.orderNumber;
            document.getElementById('ticket-date').textContent = lastOrderData.date;
            document.getElementById('ticket-customer').textContent = lastOrderData.customer;
            document.getElementById('ticket-delivery').textContent = lastOrderData.deliveryMethod;
            document.getElementById('ticket-payment').textContent = lastOrderData.paymentMethod;
            
            if (lastOrderData.paymentMethodType === 'cash') {
                document.getElementById('ticket-cash-paid').textContent = `$${lastOrderData.cashPaid}`;
                document.getElementById('ticket-cash-change').textContent = `$${lastOrderData.changeDue}`;
                document.getElementById('ticket-cash-paid-container').style.display = 'block';
                document.getElementById('ticket-cash-change-container').style.display = 'block';
            } else {
                document.getElementById('ticket-cash-paid-container').style.display = 'none';
                document.getElementById('ticket-cash-change-container').style.display = 'none';
            }
            const ticketItems = document.getElementById('ticket-items');
            ticketItems.innerHTML = '';
            lastOrderData.items.forEach(item => {
                ticketItems.innerHTML += `<div style="display:flex;justify-content:space-between;margin-bottom:5px;"><span>${item.name} (x${item.quantity})</span><span>$${(item.price * item.quantity).toFixed(2)}</span></div>`;
            });
            document.getElementById('ticket-total-final').textContent = `$${lastOrderData.total}`;
            checkoutOverlay.classList.remove('active');
            ticketOverlay.classList.add('active');
        }

        function resetCheckout() {
            currentStep = 1;
            checkoutForm.reset();
            updateCheckoutView();
        }
        
        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF(); let y = 20;
            doc.setFont('Share Tech Mono', 'normal');
            doc.setFontSize(22).setTextColor('#ff00e5').text('FASHIONSHOP', 105, y, { align: 'center' }); y += 15;
            doc.setFont('Poppins', 'normal');
            doc.setFontSize(10).setTextColor('#333');
            doc.text(`PEDIDO: ${lastOrderData.orderNumber}`, 14, y); y += 6;
            doc.text(`FECHA: ${lastOrderData.date}`, 14, y); y += 6;
            doc.text(`CLIENTE: ${lastOrderData.customer}`, 14, y); y += 10;
            doc.setDrawColor('#ff00e5').line(14, y - 4, 196, y - 4);
            lastOrderData.items.forEach(item => {
                doc.text(`${item.name} (x${item.quantity})`, 20, y);
                doc.text(`$${(item.price * item.quantity).toFixed(2)}`, 190, y, { align: 'right' }); y += 7;
            });
            doc.line(14, y, 196, y); y += 8;
            doc.text('SUBTOTAL:', 150, y, { align: 'right' }); doc.text(`$${lastOrderData.subtotal}`, 190, y, { align: 'right' }); y += 7;
            doc.text('ENVÍO:', 150, y, { align: 'right' }); doc.text(`$${lastOrderData.shipping}`, 190, y, { align: 'right' }); y += 7;
            doc.setFontSize(12).setFont(undefined, 'bold');
            doc.text('TOTAL:', 150, y, { align: 'right' }); doc.text(`$${lastOrderData.total}`, 190, y, { align: 'right' }); y += 7;
            if (lastOrderData.paymentMethodType === 'cash') {
                doc.setFontSize(10).setFont(undefined, 'normal');
                doc.text('PAGA CON:', 150, y, { align: 'right' }); doc.text(`$${lastOrderData.cashPaid}`, 190, y, { align: 'right' }); y += 7;
                doc.setFont(undefined, 'bold');
                doc.text('CAMBIO:', 150, y, { align: 'right' }); doc.text(`$${lastOrderData.changeDue}`, 190, y, { align: 'right' }); y += 7;
            }
            y += 10;
            doc.setFontSize(9).setTextColor('#888').text('GRACIAS POR TU COMPRA', 105, y, { align: 'center' });
            doc.save(`ticket-${lastOrderData.orderNumber}.pdf`);
            ticketOverlay.classList.remove('active');
        }

        function submitFeedback(e) {
            e.preventDefault();
            showNotification('MENSAJE ENVIADO');
            feedbackForm.reset();
        }
    </script>
</body>
</html>
